<% content_for(:title, "All Seasons / #{@oauth_account}") %>

<% content_for(:breadcrumb) do %>
  <%= account_switcher(@oauth_account) %> / <%= season_switcher(:all) %>
<% end %>

<div class="clearfix">
  <div class="col-6 pr-4 float-left">
    <% if @active_seasons.any? %>
      <div class="mb-4">
        <span class="text-bold">Active in seasons:</span>
        <%= @active_seasons.map(&:to_s).join(', ') %>
      </div>
    <% end %>

    <% if @lowest_sr && @highest_sr %>
      <table class="mb-4">
        <tbody>
          <tr>
            <th rowspan="2" class="pr-2">SR range:</th>
            <td class="pr-2 pb-1 text-center"><%= @lowest_sr %></td>
            <td rowspan="2" class="pr-2">&ndash;</td>
            <td class="pb-1 text-center"><%= @highest_sr %></td>
          </tr>
          <tr>
            <td class="pr-2 text-center"><%= rank_image(@lowest_sr) %></td>
            <td class="text-center"><%= rank_image(@highest_sr) %></td>
          </tr>
        </tbody>
      </table>
    <% end %>

    <div class="mb-4">
      <div class="text-bold">Matches logged:</div>
      <%= number_with_delimiter @total_matches %>
      &mdash;
      <span class="text-green">
        <span class="text-bold">
          <%= number_with_delimiter @total_wins %>
        </span>
        <%= 'win'.pluralize(@total_wins) %>
      </span>
      &middot;
      <span class="text-red">
        <span class="text-bold">
          <%= number_with_delimiter @total_losses %>
        </span>
        <%= 'loss'.pluralize(@total_losses) %>
      </span>
      &middot;
      <span class="text-orange">
        <span class="text-bold">
          <%= number_with_delimiter @total_draws %>
        </span>
        <%= 'draw'.pluralize(@total_draws) %>
      </span>
      &mdash;
      <%= @win_percent %>% win percentage
    </div>

    <% if @heroes.any? %>
      <div class="mb-4">
        <div class="text-bold mb-1">Heroes played:</div>
        <% @heroes.each do |hero| %>
          <span class="tooltipped tooltipped-n mr-2 d-inline-block" aria-label="<%= hero.name %>">
            <%= image_tag("heroes/#{hero.slug}.png", alt: hero.name, class: 'rounded-1 hero-portrait d-inline-block', width: 30, height: 30) %>
          </span>
        <% end %>
      </div>
    <% end %>
  </div>

  <% if @friends.any? %>
    <div class="col-6 float-left">
      <h2 class="h3 text-normal mt-0 mb-2">Group Members</h2>
      <div class="mb-4">
        <span class="text-bold">Grouped with:</span>
        <%= @friends.join(', ') %>
      </div>

      <div class="mb-4 d-flex flex-items-center">
        <span class="ion-ios-people mr-3 ion f1 text-gray"></span>
        <div>
          <span class="text-bold">Most frequently grouped with:</span>
          <%= @most_frequent_friends.join(', ') %>
        </div>
      </div>

      <% if @most_winning_friends.any? %>
        <div class="mb-4">
          <div class="d-flex flex-items-center">
            <span class="ion-trophy mr-3 ion f1 text-gray"></span>
            <div>
              <span class="text-bold">Most frequently won with:</span>
              <% @most_winning_friends.each do |name| %>
                <div>
                  <%= name %> &middot;
                  <span class="text-gray">
                    <%= @win_rates_by_friend[name] %>% with
                    <%= number_with_delimiter @match_counts_by_friend[name] %> <%= 'game'.pluralize(@match_counts_by_friend[name]) %>
                  </span>
                </div>
              <% end %>
            </div>
          </div>
          <p class="note mb-0">
            *Players with whom you had the highest win percentage after playing more than one match
          </p>
        </div>
      <% end %>

      <% if @most_losing_friends.any? %>
        <div class="mb-4">
          <div class="d-flex flex-items-center">
            <span class="ion-heart-broken mr-3 ion f1 text-gray"></span>
            <div>
              <span class="text-bold">Most frequently lost with:</span>
              <% @most_losing_friends.each do |name| %>
                <div>
                  <%= name %> &middot;
                  <span class="text-gray">
                    <%= @win_rates_by_friend[name] %>% with
                    <%= number_with_delimiter @match_counts_by_friend[name] %> <%= 'game'.pluralize(@match_counts_by_friend[name]) %>
                  </span>
                </div>
              <% end %>
            </div>
          </div>
          <p class="note mb-0">
            *Players with whom you had the lowest win percentage after playing more than one match
          </p>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
