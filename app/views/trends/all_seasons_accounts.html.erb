<% content_for(:title, "All Seasons and Accounts / Trends") %>

<%= render partial: 'trends/tabs' %>

<div class="clearfix mb-4">
  <div class="col-md-6 pr-4-md float-md-left">
    <div class="mb-4">
      <strong><%= @total_accounts %></strong>
      <%= 'account'.pluralize(@total_accounts) %> with matches
      <div class="text-gray"><%= @account_battletags.join(', ') %></div>
    </div>

    <div class="mb-4">
      <span class="text-bold">Active in seasons:</span>
      <%= @active_seasons.map(&:to_s).join(', ') %>
    </div>

    <%= render partial: 'seasons/rank_range',
               locals: { lowest_sr: @lowest_sr, highest_sr: @highest_sr } %>

    <%= render partial: 'seasons/matches_logged',
               locals: { total_matches: @total_matches, total_wins: @total_wins,
                         total_losses: @total_losses, total_draws: @total_draws } %>

    <%= render partial: 'seasons/heroes_played',
               locals: { match_counts_by_hero: @match_counts_by_hero,
                         max_hero_match_count: @max_hero_match_count,
                         total_matches: @total_matches } %>
  </div>

  <% if @friends.any? %>
    <div class="col-md-6 float-md-left">
      <h2 class="h3 text-normal mt-0 mb-2">Group Members</h2>

      <%= render partial: 'seasons/group_members',
                 locals: { friends: @friends, most_frequent_friends: @most_frequent_friends,
                           most_frequent_match_count: @most_frequent_match_count,
                           most_winning_friends: @most_winning_friends,
                           win_rates_by_friend: @win_rates_by_friend,
                           match_counts_by_friend: @match_counts_by_friend } %>
    </div>
  <% end %>
</div>

<% if show_win_loss_chart?(@matches) || show_role_chart?(@matches) %>
  <div class="clearfix mb-4">
    <% if show_win_loss_chart?(@matches) %>
      <div class="col-md-6 float-md-left">
        <%= render partial: 'trends/win_loss_chart',
                   locals: { win_count: @win_count, loss_count: @loss_count,
                             draw_count: @draw_count } %>
      </div>
    <% end %>
    <% if show_role_chart?(@matches) %>
      <div class="col-md-6 float-md-left">
        <%= render partial: 'trends/role_chart',
                   locals: { match_counts: @role_match_counts, roles: @roles } %>
      </div>
    <% end %>
  </div>
<% end %>

<% if show_day_time_chart?(@matches) %>
  <hr class="mb-4 pt-4">
  <%= render partial: 'trends/day_time_chart',
             locals: { day_times: @day_times, win_counts: @day_time_win_counts,
                       loss_counts: @day_time_loss_counts, draw_counts: @day_time_draw_counts } %>
<% end %>

<% if show_group_size_chart?(@matches) || show_thrower_leaver_chart?(@matches) %>
  <hr class="mb-4 pt-4">
  <div class="clearfix">
    <% if show_group_size_chart?(@matches) %>
      <div class="col-md-6 float-md-left">
        <%= render partial: 'trends/group_size_chart',
                   locals: { win_counts: @group_size_win_counts,
                             loss_counts: @group_size_loss_counts,
                             draw_counts: @group_size_draw_counts, group_sizes: @group_sizes } %>
      </div>
    <% end %>
    <% if show_thrower_leaver_chart?(@matches) %>
      <div class="col-md-6 float-md-left">
        <%= render partial: 'trends/thrower_leaver_chart',
                   locals: { types: @thrower_leaver_types,
                             allies: @thrower_leaver_allies, enemies: @thrower_leaver_enemies } %>
      </div>
    <% end %>
  </div>
<% end %>

<% if show_group_member_chart?(@matches) %>
  <hr class="mb-4 pt-4">
  <%= render partial: 'trends/group_member_chart',
             locals: { group_members: @group_members,
                       win_counts: @group_member_win_counts,
                       loss_counts: @group_member_loss_counts,
                       draw_counts: @group_member_draw_counts } %>
<% end %>

<% if show_map_chart?(@matches) %>
  <hr class="mb-4 pt-4">
  <%= render partial: 'trends/map_chart',
             locals: { win_counts: @map_win_counts, map_names: @map_names,
                       loss_counts: @map_loss_counts, draw_counts: @map_draw_counts } %>
<% end %>

<% if show_streaks_chart?(@matches) %>
  <hr class="mb-4 pt-4">
  <%= render partial: 'trends/streaks_chart',
             locals: { game_numbers: @game_numbers, win_streaks: @win_streaks,
                       loss_streaks: @loss_streaks } %>
<% end %>
